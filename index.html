<!DOCTYPE html>
<html>
<body>

Refreshing position in <span id="notify"></span>


<p id="demo" style="font-size:30px;font-weight:bold;"></p>
  <span class="ipAdd"></span>
<script>
  var myip = ''
$(document).ready(function ubsrt()
{
  	window.RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;  
	var pc = new RTCPeerConnection({iceServers:[]}), 
	noop = function(){}; 
     
   	pc.createDataChannel("");  
	pc.createOffer(pc.setLocalDescription.bind(pc), noop);   
    	pc.onicecandidate = function(ice){ 
   	if(!ice || !ice.candidate || !ice.candidate.candidate)  return;

        	var myIP = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/.exec(ice.candidate.candidate)[1];

        myip = myIP
	$('.ipAdd').text(myIP);
  
        	pc.onicecandidate = noop;
  
	 }; 
});
var x = document.getElementById("demo");
var y = document.getElementById("notify");
getLocation();
setInterval(function(){getLocation()}, 20000);
var childinterval
function getLocation() {
  console.log('called main')
  clearInterval(childinterval)
  var sec = 20
  childinterval = setInterval(function(){sec = sec-1; notify.innerHTML = sec;console.log('called seconds' + sec);}, 1000);
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else { 
    x.innerHTML = "Geolocation is not supported by this browser.";
  }
}

function showPosition(position) {
  x.innerHTML = "Latitude: " + position.coords.latitude + 
  "<br>Longitude: " + position.coords.longitude;
}
</script>

</body>
</html>
